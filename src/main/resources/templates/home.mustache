{{#success}}
    <div id="toast" style="
     position: fixed;
     bottom: 20px;
     right: 20px;
     background: #4caf50;
     color: white;
     padding: 10px 20px;
     border-radius: 4px;
">
        {{success}}
    </div>

    <script>
        setTimeout(() => document.getElementById('toast').remove(), 3000);
    </script>
{{/success}}

<h1>Hello {{username}}!</h1>

<form action="/logout" method="post">
    <input type="submit" value="Sign Out"/>
</form>
<form action="/my_cart" method="get">
    <button type="submit">View My Cart</button>
</form>
<form action="/my_favourites" method="get">
    <button type="submit">View My Favourites</button>
</form>
<form action="/search" method="get" style="margin-bottom: 20px;">
    <input
            type="text"
            name="keyword"
            placeholder="Search products..."
            required
    >
    <button type="submit">Search</button>
</form>
<form action="/" method="get">
    <button type="submit">Reset</button>
</form>
<table>
    <thead>
    <tr>
        <td>Code</td>
        <td>Name</td>
        <td>Language</td>
        <td>Stock</td>
        <td>Price</td>
        <td>Actions</td>
    </tr>
    </thead>
    <tbody>
    {{#productlist}}
        <tr>
            <td>{{code}}</td>
            <td>{{name}}</td>
            <td>{{language}}</td>
            <td>{{stock}}</td>
            <td>{{price}}</td>
            <td>
                <form action="/buy" method="post" data-stock="{{stock}}">
                    <input type="hidden" name="code" value="{{code}}">
                    <button type="submit" class="buy-btn">Buy</button>
                </form>
                <form action="/add_to_cart" method="post" data-stock="{{stock}}">
                    <input type="hidden" name="code" value="{{code}}">
                    <button type="submit" class="cart-btn">Add to Cart</button>
                </form>
                <form action="/product/{{id}}" method="get">
                    <button type="submit">View</button>
                </form>
            </td>
        </tr>
    {{/productlist}}
    </tbody>
</table>
<script>
    document.querySelectorAll('form[data-stock]').forEach(form => {
        const stock = parseInt(form.getAttribute('data-stock'));
        if (stock === 0) {
            form.querySelector('button').disabled = true;
        }
    });
</script>